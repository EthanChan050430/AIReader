<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智链 - AI智能阅读助手</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/glassmorphism.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>
<body class="dark-theme">
    <!-- 动态背景 -->
    <div id="dynamicBackground" class="dynamic-background">
        <div class="gradient-background" id="gradientBackground"></div>
        <div class="particles-container">
            <!-- 粒子将通过JS动态生成 -->
        </div>
    </div>

    <!-- 顶部导航栏 -->
    <nav class="navbar glass">
        <div class="navbar-left">
            <div class="logo">
                <i class="fas fa-link"></i>
                <span class="logo-text">智链</span>
            </div>
        </div>
        
        <div class="navbar-center">
            <div class="nav-functions">
                <button class="function-btn active" id="intelligentReading" data-function="intelligent-reading">
                    <i class="fas fa-book-reader"></i>
                    <span>智能伴读</span>
                </button>
                <button class="function-btn" id="comprehensiveAnalysis" data-function="comprehensive-analysis">
                    <i class="fas fa-chart-bar"></i>
                    <span>全面总结</span>
                </button>
                <button class="function-btn" id="expertAnalysis" data-function="expert-analysis">
                    <i class="fas fa-user-graduate"></i>
                    <span>大师分析</span>
                </button>
                <button class="function-btn" id="factChecking" data-function="fact-checking">
                    <i class="fas fa-shield-alt"></i>
                    <span>真伪鉴定</span>
                </button>
            </div>
        </div>
        
        <div class="navbar-right">
            <button class="btn-icon" id="historyToggle" title="聊天历史">
                <i class="fas fa-history"></i>
            </button>
            <button class="btn-icon" id="themeToggle" title="主题切换">
                <i class="fas fa-moon"></i>
            </button>
            <button class="btn-icon" id="backgroundToggle" title="动态背景">
                <i class="fas fa-eye"></i>
            </button>
            <div class="user-section">
                <button class="btn-primary" id="loginBtn">登录</button>
                <div class="user-info" id="userInfo" style="display: none;">
                    <span class="username" id="username"></span>
                    <button class="btn-icon" id="logoutBtn" title="登出">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- 主容器 -->
    <div class="app-container">
        <!-- 聊天历史面板 -->
        <div class="history-panel" id="historyPanel">
            <div class="history-header">
                <h3><i class="fas fa-history"></i> 聊天历史</h3>
                <div class="history-controls">
                    <button class="btn-icon" id="newChatBtn" title="新建对话">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button class="btn-icon" id="exportHistoryBtn" title="导出历史">
                        <i class="fas fa-download"></i>
                    </button>
                    <button class="btn-icon" id="clearHistoryBtn" title="清空历史">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
            <div class="history-search">
                <input type="text" id="historySearch" placeholder="搜索聊天记录..." />
                <i class="fas fa-search"></i>
            </div>
            <div class="session-list" id="sessionList">
                <!-- 会话列表将动态加载 -->
            </div>
        </div>

        <!-- 主内容区域 -->
        <main class="main-content">
            <!-- 欢迎界面 -->
            <div class="welcome-screen" id="welcomeScreen">
                <div class="welcome-content">
                    <div class="welcome-header">
                        <h1 class="welcome-title">
                            <span class="gradient-text">智链</span>
                            <span class="subtitle">AI智能阅读助手</span>
                        </h1>
                        <p class="welcome-description">
                            上传链接、文档或图片，让AI助手为您提供智能分析和深度解读
                        </p>
                    </div>

                    <!-- 上传区域 -->
                    <div class="upload-section">
                        <div class="upload-tabs">
                            <button class="upload-tab active" data-type="text">
                                <i class="fas fa-keyboard"></i>
                                <span>文本输入</span>
                            </button>
                            <button class="upload-tab" data-type="url">
                                <i class="fas fa-link"></i>
                                <span>链接</span>
                            </button>
                            <button class="upload-tab" data-type="file">
                                <i class="fas fa-file-alt"></i>
                                <span>文档</span>
                            </button>
                            <button class="upload-tab" data-type="image">
                                <i class="fas fa-image"></i>
                                <span>图片</span>
                            </button>
                        </div>
                        
                        <div class="upload-content">
                            <!-- 文本输入面板 -->
                            <div class="upload-panel active" data-type="text">
                                <div class="input-wrapper">
                                    <textarea 
                                        id="textInput"
                                        placeholder="请输入要分析的文本内容..."
                                        rows="6"
                                    ></textarea>
                                </div>
                            </div>
                            
                            <!-- URL输入面板 -->
                            <div class="upload-panel" data-type="url">
                                <div class="input-wrapper">
                                    <textarea 
                                        id="urlInput"
                                        placeholder="请输入网页链接（支持多个，每行一个）"
                                        rows="4"
                                    ></textarea>
                                </div>
                            </div>
                            
                            <!-- 文件上传面板 -->
                            <div class="upload-panel" data-type="file">
                                <div class="file-upload-area" id="fileUploadArea">
                                    <div class="upload-icon">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                    </div>
                                    <p class="upload-text">拖拽文件到此处或<span class="click-to-upload">点击选择</span></p>
                                    <p class="upload-hint">支持 PDF、DOCX、TXT 格式，最大 10MB</p>
                                    <input type="file" id="fileInput" accept=".pdf,.docx,.txt" multiple style="display: none;">
                                </div>
                                <div class="file-list" id="fileList"></div>
                            </div>
                            
                            <!-- 图片上传面板 -->
                            <div class="upload-panel" data-type="image">
                                <div class="image-upload-area" id="imageUploadArea">
                                    <div class="upload-icon">
                                        <i class="fas fa-image"></i>
                                    </div>
                                    <p class="upload-text">拖拽图片到此处或<span class="click-to-upload">点击选择</span></p>
                                    <p class="upload-hint">支持 JPG、PNG、GIF 格式，最大 10MB</p>
                                    <input type="file" id="imageInput" accept="image/*" multiple style="display: none;">
                                </div>
                                <div class="image-preview" id="imagePreview"></div>
                            </div>
                        </div>
                        
                        <div class="upload-actions">
                            <button class="btn-primary" id="startAnalysisBtn">
                                <i class="fas fa-paper-plane"></i>
                                开始分析
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 聊天界面 -->
            <div class="chat-screen" id="chatScreen" style="display: none;">
                <div class="chat-container">
                    <!-- 聊天消息区域 -->
                    <div class="chat-messages" id="chatMessages">
                        <!-- 消息将动态加载 -->
                    </div>

                    <!-- 进度指示器 -->
                    <div class="progress-container" id="progressContainer" style="display: none;">
                        <div class="progress-steps">
                            <div class="progress-step" data-step="1">
                                <div class="step-circle">1</div>
                                <span class="step-label">解析内容</span>
                            </div>
                            <div class="progress-step" data-step="2">
                                <div class="step-circle">2</div>
                                <span class="step-label">分析处理</span>
                            </div>
                            <div class="progress-step" data-step="3">
                                <div class="step-circle">3</div>
                                <span class="step-label">深度思考</span>
                            </div>
                            <div class="progress-step" data-step="4">
                                <div class="step-circle">4</div>
                                <span class="step-label">生成结果</span>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    </div>

                    <!-- 输入区域 -->
                    <div class="chat-input-container">
                        <div class="input-area">
                            <textarea 
                                id="searchInput"
                                placeholder="继续对话..."
                                rows="1"
                            ></textarea>
                            <button class="btn-send" id="sendButton">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                        <div class="input-actions">
                            <button class="btn-icon" id="clearChatBtn" title="清空对话">
                                <i class="fas fa-broom"></i>
                            </button>
                            <button class="btn-icon" id="compactModeToggle" title="简洁模式">
                                <i class="fas fa-compress"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 进度分析界面 -->
            <div class="progress-screen" id="progressScreen" style="display: none;">
                <div class="progress-container">
                    <div class="progress-header">
                        <h2 id="progressTitle">正在分析...</h2>
                        <button class="btn-icon" id="backToWelcomeBtn" title="返回主页">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                    </div>
                    
                    <!-- 新的步骤界面设计 -->
                    <div class="analysis-steps-container" id="analysisSteps">
                        <!-- 步骤卡片将动态生成 -->
                    </div>
                    
                    <!-- 步骤详情模态框 -->
                    <div class="step-detail-modal" id="stepDetailModal" style="display: none;">
                        <div class="modal-backdrop" onclick="closeStepDetail()"></div>
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3 id="stepDetailTitle">步骤详情</h3>
                                <button class="close-btn" onclick="closeStepDetail()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div id="stepDetailContent" class="step-content">
                                    <!-- 详细内容将在这里显示 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 模态框容器 -->
    <div class="modal-overlay" id="modalOverlay" style="display: none;">
        <!-- 模态框内容将动态加载 -->
    </div>

    <!-- 认证模态框 -->
    <div class="modal-overlay" id="authModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="authTitle">登录</h3>
                <button class="close-btn" onclick="window.authManager?.hideAuthModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="authForm">
                    <div class="form-group">
                        <label for="authUsername">用户名</label>
                        <input type="text" id="authUsername" name="username" required>
                    </div>
                    <div class="form-group">
                        <label for="authPassword">密码</label>
                        <input type="password" id="authPassword" name="password" required>
                    </div>
                    <div class="form-group" id="authEmailGroup" style="display: none;">
                        <label for="authEmail">邮箱</label>
                        <input type="email" id="authEmail" name="email">
                    </div>
                    <button type="submit" class="btn-primary" id="authSubmitBtn">登录</button>
                </form>
                <div class="auth-switch">
                    <span id="authSwitchText">还没有账号？</span>
                    <a href="#" id="authSwitchLink">立即注册</a>
                </div>
            </div>
        </div>
    </div>

    <!-- 通知容器 -->
    <div class="notification-container" id="notificationContainer">
        <!-- 通知将动态加载 -->
    </div>

    <!-- 加载指示器 -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p class="loading-text" id="loadingText">正在处理...</p>
        </div>
    </div>

    <!-- JavaScript文件 -->
    <script src="js/utils.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/upload.js"></script>
    <script src="js/progress.js"></script>
    <script src="js/chat.js"></script>
    <script src="js/history.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
